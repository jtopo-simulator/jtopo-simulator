<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>拓扑管理</title>
    <link rel="stylesheet" href="../css/topology-manage.css"/>
    <link rel="stylesheet" href="../css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../css/jquery.dataTables.css"/>
    <link rel="stylesheet" href="../css/animate.css"/>
    <script src="../js/vue.js"></script>
    <script src="../js/jquery-1.11.3.js"></script>
    <script src="../js/jquery.dataTables.js"></script>
    <script src="../js/demo.js"></script>
</head>
<body>
<div id="myModal" class="modal" data-backdrop="static">
    <!--第二层-->
    <div class="">
        <!--第三层 :背景，边框，倒角，阴影-->
        <div class="modal-content">
            <!--第四层：控制内容-->
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 id="modal-title">新建拓扑</h4>
            </div>
            <div class="modal-body">
                <form>
                    <fieldset id="fieldset">
                        <div class="form-group">
                            <label for="disabledTextInput">拓扑名称</label>
                            <input type="text" id="disabledTextInput" class="form-control" placeholder="请输入拓扑名称">
                        </div>
                        <div class="form-group">
                            <label for="disabledSelect">新建方式</label>
                            <select id="disabledSelect" class="form-control">
                                <option>从头开始新建</option>
                                <option>导入已有拓扑</option>
                            </select>
                        </div>
                        <div class="form-group" id="topo_class">
                            <label for="topo-type">拓扑类型</label>
                            <select id="topo-type" class="form-control">
                                <option>传统拓扑</option>
                                <option>SDN拓扑</option>
                            </select>
                        </div>
                        <div class="form-group" id="choose_file_calss" style="display: none">
                            <label for="choose_file" >导入文件</label>
                            <input type="file" id="choose_file"/>
                        </div>
                        <!--<div class="checkbox">-->
                            <!--<label>-->
                                <!--<input type="checkbox"> Can't check this-->
                            <!--</label>-->
                        <!--</div>-->
                        <button type="button" id="modal-sure">确定</button>
                        <button type="button" class="btn btn-default" data-dismiss="modal" id="modal-exit">取消</button>
                    </fieldset>
                </form>

            </div>

        </div>
    </div>
</div>
<div id="container">
    <!-- 左侧边栏-->
    <div id="left-navigation">
        <ul>
            <li class="animated wobble">
                <img src="../images/u470.png" alt=""/>
                <img src="../images/u468.png" alt=""/>
            </li>
            <a href="panel.html">
                <li>

                    <span class="glyphicon glyphicon-home" style="font-size: 20px">
                        <!--<img src="../images/2017-08-04_180433.png" alt=""/>-->
                    </span>
                    <p>仪表面板</p>

                </li>
            </a>
            <a href="quick-avigation.html">
                <li>
                    <span class="glyphicon glyphicon-flag" style="font-size: 22px">
                        <!--<img src="../images/2017-08-04_180453.png" alt=""/>-->
                    </span>
                    <p>快速向导</p>
                </li>
            </a>
            <a href="topology-manage.html" style="transform:scale(1.15);">
                <li >
                    <span class="glyphicon glyphicon-calendar" style="font-size: 22px;color: #0288D1;">
                        <!--<img src="../images/2017-08-04_180506.png" alt=""/>-->
                    </span>
                    <p style="color: #0288D1" class="animated bounce">拓扑管理</p>
                </li>
            </a>
            <a href="log-manage.html">
                <li >
                    <span class="glyphicon glyphicon-list-alt" style="font-size: 22px">
                        <!--<img src="../images/2017-08-04_180522.png" alt=""/>-->
                    </span>
                    <p>日志管理</p>
                </li>
            </a>
            <a href="system-manage.html">
                <li >
                    <span class="glyphicon glyphicon-cog" style="font-size: 22px">
                        <!--<img src="../images/2017-08-04_180543.png" alt=""/>-->
                    </span>
                    <p>系统管理</p>
                </li>
            </a>
            <a href="user-manage.html">
                <li >
                    <span class="glyphicon glyphicon-user" style="font-size: 22px">
                        <!--<img src="../images/2017-08-14_124435.png" alt=""/>-->
                    </span>
                    <p>用户管理</p>
                </li>
            </a>
            <a href="analysis.html">
                <li >
                    <span class="glyphicon glyphicon-signal" style="font-size: 22px">
                        <!--<img src="../images/2017-08-14_124453.png" alt=""/>-->
                    </span>
                    <p>统计分析</p>
                </li>
            </a>
            <a href="personal.html">
                <li >
                    <span class="glyphicon glyphicon-envelope" style="font-size: 22px">
                        <!--<img src="../images/2017-08-14_124507.png" alt=""/>-->
                    </span>
                    <p>个人中心</p>
                </li>
            </a>
        </ul>
    </div>
    <!-- top导航-->
    <div id="top-navigation">
        <ul id="top-navigation-left">
            <li>中国电信云计算实验室</li>
            <li class="animated rubberBand">网络模拟平台</li>
        </ul>
        <ul id="top-navigation-right">
            <li class="animated tada"><img src="../images/u74.png" alt=""/></li>
            <li>Welcome, <span id="user" class="user">Administrator</span></li>
            <li class="">
                    <span>
                        <a href="login.html" >
                            <img src="../images/exit.png" alt="" id="exit" title="退出系统"/>
                        </a>
                    </span>
            </li >
        </ul>
    </div>
    <!-- 主面板-->
    <div id="section">
        <div id="quick-create">
            <ul>
                <li class="animated fadeInRight" style="visibility: visible; animation-delay: 0.1s; animation-name: fadeInRight;">快速创建拓扑向导</li>
                <li class="animated fadeInRight">传统拓扑: 100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SDN拓扑: 10</li>
            </ul>

        </div>
        <div id="create" >
            <button id="btn" data-toggle="modal" data-target="#myModal" class="animated bounceInUp">新建拓扑</button>
            <div class="domab" style="position: relative">
                <div class="" style="float:right;">
                    <label>
                        <input type="text" class="dsearch" placeholder="请输入关键字..." aria-controls="example" id="search-input">
                        <img src="../images/2017-08-18_165039.png" alt="" id="search-img">
                    </label>
                </div>

                <button id="button" style="float:left;" >删除拓扑</button>
                <button id="button_d" style="float:left;">下载拓扑</button>
                <!--<button id="button" style="float:left;" >下载拓扑</button>-->
                <div style="float:left; position:relative; z-index:9999;height:100%;">
                    <!--<button class="showcol">列段显示/隐藏</button>-->
                    <!--<ul class="showul"-->
                    <!--style=" list-style:none;display:none; position:absolute; left:80px; top:10px; background:#FFFFFF; border:1px solid #ccc; width:200px;">-->
                    <!--<li>-->
                    <!--<input type="checkbox" class="toggle-vis" data-column="2"/>-->
                    <!--服务器名称-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<input type="checkbox" class="toggle-vis" data-column="3"/>-->
                    <!--IP-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<input type="checkbox" class="toggle-vis" data-column="4"/>-->
                    <!--CPU/内存-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<input type="checkbox" class="toggle-vis" data-column="5"/>-->
                    <!--数据盘大小-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<input type="checkbox" class="toggle-vis" data-column="6"/>-->
                    <!--操作系统-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<input type="checkbox" class="toggle-vis" data-column="7"/>-->
                    <!--状态-->
                    <!--</li>-->
                    <!--</ul>-->
                </div>
                <div style="clear:both;"></div>
            </div>
            <div class="wt100" style="position:relative; overflow:hidden; height:100%">
                <table id="example" class="display animated slideInUp" cellspacing="0" width="100%" >
                    <thead>
                    <tr>
                        <th style=" width:1px; padding:0"></th>
                        <th style="width:30px; padding:10px 0 10px 10px">
                            <input type="checkbox" id="checkAll"></th>
                        <th>拓扑名称</th>
                        <th>创建时间</th>
                        <th>创建者</th>
                        <th>拓扑类型</th>
                        <!--<th>操作系统</th>-->
                        <!--<th>状态</th>-->
                    </tr>
                    </thead>

                    <tfoot>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <!--<th></th>-->
                        <!--<th></th>-->
                    </tr>
                    </tfoot>
                    <tbody>
                    <tr>
                        <td></td>
                        <td>
                            <input type="checkbox" name="checkList" class="clickdom" href="javascript:;" isclick="true" onClick="clickDom(this);"></td>
                        <td>
                            <a >测试拓扑1</a>
                        </td>
                        <td>2017-6-15</td>
                        <td>Administrator</td>
                        <td>传统</td>
                        <!--<td>CentOS 56.5</td>-->
                        <!--<td>运行中</td>-->
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <input type="checkbox" name="checkList" class="clickdom" href="javascript:;" isclick="true" onClick="clickDom(this);"></td>
                        <td>
                            <a >Testing</a>
                        </td>
                        <td>2017-4-22</td>
                        <td>RemoteAdmin</td>
                        <td>SDN</td>
                        <!--<td>-->
                        <!--<div style="height:21px; line-height:21px; overflow:hidden; width:100px;">CentO核核核核核核核核核核核核核核核核核核核核核vS-->
                        <!--53.5-->
                        <!--</div>-->
                        <!--</td>-->
                        <!--<td>已停止</td>-->
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <input type="checkbox" name="checkList" class="clickdom" href="javascript:;" isclick="true" onClick="clickDom(this);"></td>
                        <td>
                            <a >IDC模拟链路</a>
                        </td>
                        <td>2017-4-22</td>
                        <td>test</td>
                        <td>传统</td>
                        <!--<td>CentOS 52.5</td>-->
                        <!--<td>运行中</td>-->
                    </tr>



                    </tbody>
                </table>
                <div class="showslider">
                    console.log($(this));
                    <button class="closediv">关闭</button>
                </div>
                <style>
                    .showslider {
                        display: none;
                        width: 25%;
                        height: 100%;
                        background-color: #fff;
                        border: 1px solid #ccc;
                        position: absolute;
                        top: 9px;
                    }

                    .addselect {
                        border-radius: 2px;
                        display: inline-block;
                        background-color: #ccc;
                        height: 12px;
                        width: 16px;
                        text-align: center;
                        color: #fff;
                        font-size: 9px;
                        font-family: Arial;
                        position: relative;
                        margin-left: 4px;
                        cursor: pointer;
                        overflow: hidden;
                        vertical-align: top;
                        top: 1px;
                    }

                    .addselect select {
                        width: 44px;
                        opacity: 0;
                        position: absolute;
                        left: 0;
                        top: 0;
                        cursor: pointer;
                    }

                    table.dataTable tbody th, table.dataTable th, table.dataTable tbody td {
                        font-size: 12px;
                        text-align: left;
                    }

                    table.dataTable thead th {
                        padding: 0 8px;
                    }
                    #example a{
                        cursor: pointer;
                    }
                </style>
            </div>
        </div>
    </div>
</div>
<script src="../js/bootstrap.min.js"></script>
<!--<script>-->
    <!--var app=new Vue({-->
        <!--el:'#container',-->
        <!--data(){-->
        <!--return{-->
            <!--users:[-->
                <!--{name:'测试拓扑1',time:'2017-6-15',people:'Administrator',type:'传统'},-->
                <!--{name:'SDN双线拓扑',time:'2017-8-15',people:'Test',type:'SDN'},-->
                <!--{name:'测试拓扑1',time:'2017-6-15',people:'Administrator',type:'传统'},-->
                <!--{name:'SDN双线拓扑',time:'2017-8-15',people:'Test',type:'SDN'},-->
                <!--{name:'测试拓扑1',time:'2017-6-15',people:'Administrator',type:'传统'},-->
                <!--{name:'SDN双线拓扑',time:'2017-8-15',people:'Test',type:'SDN'},-->
                <!--{name:'测试拓扑1',time:'2017-6-15',people:'Administrator',type:'传统'},-->
                <!--{name:'SDN双线拓扑',time:'2017-8-15',people:'Test',type:'SDN'},-->
                <!--{name:'测试拓扑1',time:'2017-6-15',people:'Administrator',type:'传统'},-->
                <!--{name:'SDN双线拓扑',time:'2017-8-15',people:'Test',type:'SDN'},-->
            <!--],-->


        <!--}-->
    <!--},-->
    <!--methods:{-->
        <!--handle:function(x){-->
            <!--this.users.splice(x,1);-->
        <!--}-->
    <!--}-->
    <!--//-->
    <!--})-->
<!--</script>-->
<script>
    $(function () {

        var table = $('#example').DataTable({
            "dom": '<"top"f >rt<"bottom"ilp><"clear">',//dom定位
            "dom": 'tiprl',//自定义显示项
            //"dom":'<"domab"f>',
            "scrollY": "305px",//dt高度
            "lengthMenu": [
                [8, 6, 8, -1],
                [4, 6, 8, "All"]
            ],//每页显示条数设置
            "lengthChange": false,//是否允许用户自定义显示数量
            "bPaginate": true, //翻页功能
            "bFilter": false, //列筛序功能
            "searching": true,//本地搜索
            "ordering": true, //排序功能
            "Info": true,//页脚信息
            "autoWidth": true,//自动宽度
            "oLanguage": {//国际语言转化
                "oAria": {
                    "sSortAscending": " - click/return to sort ascending",
                    "sSortDescending": " - click/return to sort descending"
                },
                "sLengthMenu": "显示 _MENU_ 记录",
                "sZeroRecords": "对不起，查询不到任何相关数据",
                "sEmptyTable": "未有相关数据",
                "sLoadingRecords": "正在加载数据-请等待...",
                "sInfo": "当前显示 _START_ 到 _END_ 条，共 _TOTAL_ 条记录。",
                "sInfoEmpty": "当前显示0到0条，共0条记录",
                "sInfoFiltered": "（数据库中共为 _MAX_ 条记录）",
                "sProcessing": "<img src='../resources/user_share/row_details/select2-spinner.gif'/> 正在加载数据...",
                "sSearch": "模糊查询：",
                "sUrl": "",
                //多语言配置文件，可将oLanguage的设置放在一个txt文件中，例：Javascript/datatable/dtCH.txt
                "oPaginate": {
                    "sFirst": "首页",
                    "sPrevious": " 上一页 ",
                    "sNext": " 下一页 ",
                    "sLast": " 尾页 "
                }
            },

            "columnDefs": [
                {
                    orderable: false,

                    targets: 0 },
                {
                    orderable: false,

                    targets: 1 }
            ],//第一列与第二列禁止排序

            "order": [
                [0, null]
            ],//第一列排序图标改为默认
            initComplete: function () {//列筛选
                var api = this.api();
                api.columns().indexes().flatten().each(function (i) {
                    if (i != 0 && i != 1) {//删除第一列与第二列的筛选框
                        var column = api.column(i);
                        var $span = $('<span class="addselect">▾</span>').appendTo($(column.header()))
                        var select = $('<select><option value="">All</option></select>')
                                .appendTo($(column.header()))
                                .on('click', function (evt) {
                                    evt.stopPropagation();
                                    var val = $.fn.dataTable.util.escapeRegex(
                                            $(this).val()
                                    );
                                    column
                                            .search(val ? '^' + val + '$' : '', true, false)
                                            .draw();
                                });
                        column.data().unique().sort().each(function (d, j) {
                            function delHtmlTag(str) {
                                return str.replace(/<[^>]+>/g, "");//去掉html标签
                            }

                            d = delHtmlTag(d)
                            select.append('<option value="' + d + '">' + d + '</option>')
                            $span.append(select)
                        });

                    }
                });

            }

        });

        //添加索引列
        table.on('order.dt search.dt',
                function () {
                    table.column(0, {
                        search: 'applied',
                        order: 'applied'
                    }).nodes().each(function (cell, i) {
                        cell.innerHTML = i + 1;
                    });
                }).draw();

        //自定义搜索
        $('.dsearch').on('keyup click', function () {
            var tsval = $(".dsearch").val()
            table.search(tsval, false, false).draw();
        });

        //checkbox全选
        $("#checkAll").on("click", function () {
            if ($(this).prop("checked") === true) {
                $("input[name='checkList']").prop("checked", $(this).prop("checked"));
                $('#example tbody tr').addClass('selected');
            } else {
                $("input[name='checkList']").prop("checked", false);
                $('#example tbody tr').removeClass('selected');
            }
        });

        //显示隐藏列
        $('.toggle-vis').on('change', function (e) {
            e.preventDefault();
            console.log($(this).attr('data-column'));
            var column = table.column($(this).attr('data-column'));
            column.visible(!column.visible());
        });

        //删除选中行
        $('#example tbody').on('click', 'tr input[name="checkList"]', function () {
            var $tr = $(this).parents('tr');
            $tr.toggleClass('selected');
            var $tmp = $('[name=checkList]:checkbox');
            $('#checkAll').prop('checked', $tmp.length == $tmp.filter(':checked').length);

        });

        $('#button').click(function () {
            table.row('.selected').remove().draw(false);
        });
        $('#button_d').click(function () {//下载
//            table.row('.selected').remove().draw(false);
            console.log(table.row('.selected'));
        });

        $('.showcol').click(function () {
            $('.showul').toggle();

        })

        //获取表格宽度赋值给右侧弹出层
        wt = $('.wt100').width();
        $('.showslider').css('right', -wt);

        //关闭右侧弹出层
        $('.closediv').click(function () {
            $(this).parent('.showslider').animate({
                right: -wt
            }, 100);
            $('input[name="checkList"]').attr("checked",false);
            $('.clickdom').attr('isclick', true)
        });


    })

    //右侧弹出详情层
      var flag=false;
     function clickDom(obj){
//         alert(222)
     var  $par=$(obj).parents('#example_wrapper').siblings('.showslider');
     var  isattr=$(obj).attr('isclick');
     if(isattr=="true"){
     if(flag){
     $par.animate({
     right:-wt
     },200);
     flag=!flag
     }
     else{
     $par.animate({
     right:0
     },200);
     flag=!flag

     }
     }
     $('.clickdom').attr('isclick',false);
     $(obj).attr('isclick',true);


     }

    function clickDom(obj) {
        var $par = $(obj).parents('#example_wrapper').siblings('.showslider');
        var isattr = $(obj).attr('isclick');
        if (isattr == "false") {
//        alert(111)
            $par.animate({
                right: -wt
            }, 200);
//            $par.animate({
//                right: 0
//            }, 400);
            $('.clickdom').attr('isclick', true);
            $(obj).attr('isclick', false);

        } else {
            $par.animate({
                right: -wt
            }, 200);
            $par.animate({
                right: 0
            }, 400);
            $('.clickdom').attr('isclick', true);
            $(obj).attr('isclick', false)
        }

    }

    console.log($('#disabledSelect').val());
    $('#disabledSelect').mouseup(function () {
        if($('#disabledSelect').val()=='导入已有拓扑'){
            $('#topo_class').hide();
            $('#choose_file_calss').fadeIn()
        }else if($('#disabledSelect').val()=='从头开始新建'){
            $('#choose_file_calss').hide();
            $('#topo_class').fadeIn();

        }
    });

//    跳转

    $('#modal-sure').click(function () {
        var myTopoName = $('#disabledTextInput').val();
        var myTopoType=$('#topo-type').val();
        localStorage['toponame'] = myTopoName;
        localStorage['topotype'] = myTopoType;
        if(myTopoName !=''){
            location.href='check-topology.html'
        }else{alert('拓扑名称不能为空')}

    })

</script>
</body>
</html>